## שאלה 2 – בטיחות להרצה מקבילית במחלקה StockServer

במקרה המתואר בשאלה, הדרך הטובה ביותר להפוך את המחלקה StockServer לבטוחה להרצה מקבילית היא **אפשרות א׳ – הפיכת המחלקה ל־immutable**.

המחלקה StockServer מספקת גישה לקריאה בלבד של ערכי המניות ואינה משנה את מצבה הפנימי בזמן ריצה. כאשר מחלקה היא immutable (כלומר, השדות בה קבועים ואין מתודות שמשנות מצב), ניתן לאפשר גישה מקבילית ממספר תהליכונים ללא צורך במנגנוני סנכרון.

פתרון זה עדיף על שימוש ב־synchronized, מאחר והוא מונע נעילות מיותרות, מפשט את הקוד ומשפר ביצועים. שימוש בסנכרון היה נדרש רק אם ערכי המניות היו משתנים במהלך הריצה.




## שאלה 4 – השפעת StockUpdateThread על בטיחות להרצה מקבילית

לאחר הוספת התהליכון StockUpdateThread, תשובתי לסעיף 2 **משתנה**.

בסעיף 2 בחרתי באפשרות א׳ (מחלקה immutable), אך לאחר הוספת StockUpdateThread המחלקה StockServer **כבר אינה immutable**, משום שערכי המניות משתנים בזמן ריצה באמצעות המתודה updateStock.

במצב זה, הדרך הנכונה והבטוחה להפוך את StockServer לבטוחה להרצה מקבילית היא **אפשרות ב׳ – שימוש במנגנוני סנכרון (synchronized)**.  
לכן, גם המתודה GetStock וגם המתודה updateStock סומנו כ־synchronized, כך שקריאה וכתיבה לערכי המניות מתבצעות בצורה אטומית ומוגנת מפני תנאי מרוץ (race conditions).

באופן זה מובטחת בטיחות להרצה מקבילית גם כאשר מספר תהליכונים קוראים וכותבים לערכי המניות בו־זמנית.

